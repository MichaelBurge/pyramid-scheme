#lang pyramid

(require psl "primitives.pmd")
(require psl "syntax.pmd")

(define vec (%#-unbox-arguments %#-mem-alloc-init (%#-* (%-unbox WORD) (%-unbox 10)) 3 1 4 1 5 9 2 6 5 3))

(%-box (syntax-fold %#-+
                    (%#-mem-read vec (%-unbox 0)) ; + 3 = 3
                    (%#-mem-read vec (%-unbox 1)) ; + 1 = 4
                    (%#-mem-read vec (%-unbox 2)) ; + 4 = 8
                    (%#-mem-read vec (%-unbox 3)) ; + 1 = 9
                    (%#-mem-read vec (%-unbox 4)) ; + 5 = 14
                    (%#-mem-read vec (%-unbox 5)) ; + 9 = 23
                    (%#-mem-read vec (%-unbox 6)) ; + 2 = 25
                    (%#-mem-read vec (%-unbox 7)) ; + 6 = 31
                    (%#-mem-read vec (%-unbox 8)) ; + 5 = 36
                    (%#-mem-read vec (%-unbox 9)) ; + 3 = 39
                    ))

(set-test-result! 39)
